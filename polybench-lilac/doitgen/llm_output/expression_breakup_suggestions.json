{
  "function_name": "kernel_sum",
  "breakups": [
    {
      "line_number": 183,
      "original_expression": "sum[((r * nq + q) * np + p)] = 0;",
      "breakup_steps": [
        {
          "temp_var": "rq_index",
          "expression": "r * nq + q",
          "description": "Flatten r and q into a single index"
        },
        {
          "temp_var": "row_offset",
          "expression": "rq_index * np",
          "description": "Stride by np to get the start of the (r,q) row in the np dimension"
        },
        {
          "temp_var": "sum_idx",
          "expression": "row_offset + p",
          "description": "Compute the final index for sum at position p"
        }
      ],
      "final_expression": "sum[sum_idx] = 0;"
    },
    {
      "line_number": 186,
      "original_expression": "dot = (dot + (A[((r * nq + q) * np + s)] * C4[(s * np + p)]));",
      "breakup_steps": [
        {
          "temp_var": "rq_index",
          "expression": "r * nq + q",
          "description": "Flatten r and q into a single index"
        },
        {
          "temp_var": "row_offset",
          "expression": "rq_index * np",
          "description": "Stride by np to get the start of the (r,q) row in the np dimension"
        },
        {
          "temp_var": "a_idx",
          "expression": "row_offset + s",
          "description": "Index into A for current s"
        },
        {
          "temp_var": "c4_idx",
          "expression": "s * np + p",
          "description": "Index into C4 for (s, p)"
        },
        {
          "temp_var": "a_val",
          "expression": "A[a_idx]",
          "description": "Load value from A at computed index"
        },
        {
          "temp_var": "c4_val",
          "expression": "C4[c4_idx]",
          "description": "Load value from C4 at computed index"
        },
        {
          "temp_var": "prod",
          "expression": "a_val * c4_val",
          "description": "Multiply the two loaded values"
        },
        {
          "temp_var": "dot_updated",
          "expression": "dot + prod",
          "description": "Accumulate the product into dot"
        }
      ],
      "final_expression": "dot = dot_updated;"
    },
    {
      "line_number": 188,
      "original_expression": "sum[((r * nq + q) * np + p)] = dot;",
      "breakup_steps": [
        {
          "temp_var": "rq_index",
          "expression": "r * nq + q",
          "description": "Flatten r and q into a single index"
        },
        {
          "temp_var": "row_offset",
          "expression": "rq_index * np",
          "description": "Stride by np to get the start of the (r,q) row in the np dimension"
        },
        {
          "temp_var": "sum_idx",
          "expression": "row_offset + p",
          "description": "Compute the final index for sum at position p"
        }
      ],
      "final_expression": "sum[sum_idx] = dot;"
    }
  ]
}